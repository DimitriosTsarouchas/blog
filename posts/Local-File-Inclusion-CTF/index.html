<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Local File Inclusion CTF" /><meta name="author" content="Dimitrios Tsarouchas" /><meta property="og:locale" content="en_US" /><meta name="description" content="This is my personal website where I upload content I find useful for me and share it to people that are interested in cybersecurity. Everything posted in this website is for ethical academic research and I am not responsible if anyone will use the information provided here for illegal activities." /><meta property="og:description" content="This is my personal website where I upload content I find useful for me and share it to people that are interested in cybersecurity. Everything posted in this website is for ethical academic research and I am not responsible if anyone will use the information provided here for illegal activities." /><link rel="canonical" href="https://dimitrios-tsarouchas.tech//posts/Local-File-Inclusion-CTF/" /><meta property="og:url" content="https://dimitrios-tsarouchas.tech//posts/Local-File-Inclusion-CTF/" /><meta property="og:site_name" content="Dimitris Tsarouchas" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-02T12:55:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Local File Inclusion CTF" /><meta name="twitter:site" content="@DimitriosTsaro3" /><meta name="twitter:creator" content="@Dimitrios Tsarouchas" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Dimitrios Tsarouchas"},"description":"This is my personal website where I upload content I find useful for me and share it to people that are interested in cybersecurity. Everything posted in this website is for ethical academic research and I am not responsible if anyone will use the information provided here for illegal activities.","url":"https://dimitrios-tsarouchas.tech//posts/Local-File-Inclusion-CTF/","@type":"BlogPosting","headline":"Local File Inclusion CTF","dateModified":"2021-03-11T00:13:03+00:00","datePublished":"2021-02-02T12:55:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://dimitrios-tsarouchas.tech//posts/Local-File-Inclusion-CTF/"},"@context":"https://schema.org"}</script><title>Local File Inclusion CTF | Dimitris Tsarouchas</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/picture%20me.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Dimitris Tsarouchas</a></div><br><div class="site-subtitle font-italic">Cybersecurity, CTFs and Technology</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <script src="https://tryhackme.com/badge/44835"></script> <a href="https://github.com/DimitriosTsarouchas" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://linkedin.com/in/dimitrios-tsarouchas" aria-label="linkedin" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-linkedin-in"></i> </a> <a href="https://twitter.com/DimitriosTsaro3" aria-label="twitter" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['dimitristsaroucha','gmail.com'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-7" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Local File Inclusion CTF</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Local File Inclusion CTF</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Feb 2, 2021, 12:55 PM +0000" > Feb 2 <i class="unloaded">2021-02-02T12:55:00+00:00</i> </span> by <span class="author"> Dimitrios Tsarouchas </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Mar 11, 2021, 12:13 AM +0000" > Mar 11 <i class="unloaded">2021-03-11T00:13:03+00:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="521 words">2 min</span></div></div><div class="post-content"><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/lfi-2.jpg" alt="Local File Inclusion" /></p><h2 id="introduction">Introduction</h2><p>In this article we are going to capture root flag on a Linux machine using Local File Inclusion vulnerability. We have shown in <a href="/posts/Local-File-Inclusion/">previous article</a> that an attacker gets advantage of improper input sanitisation by changing the value of a parameter in the website’s URL.</p><h2 id="exploring-the-website-to-find-ways-for-lfi-attack">Exploring the website to find ways for LFI attack</h2><p>Opening the given ip address using Firefox we are directed to Falcon’s website home page where we can see three articles been posted. We are looking for a parameter that we can modify to gain access to <code class="language-plaintext highlighter-rouge">/etc/passwd</code> file.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/LFI/falconfeastwebsitemainpage.png" alt="Falconfeast website" /> <em>falconfeast’s website home page</em></p><p>By clicking on view details on the “Hacking this world” post and checking the URL address bar we can find the <code class="language-plaintext highlighter-rouge">name</code> parameter along with its value.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/LFI/Parametername.png" alt="Parameter name" /> <em>Parameter name seem to be vulnerable to LFI</em></p><h2 id="searching-for-users-in-the-etcpasswd-file">Searching for users in the /etc/passwd file</h2><p>Now that we found the variable <code class="language-plaintext highlighter-rouge">name</code> we will try to check if it is vulneable to LFI attack by passing the value of <code class="language-plaintext highlighter-rouge">../../../../etc/passwd</code>.</p><p>And….BOOM!!!</p><p>The <code class="language-plaintext highlighter-rouge">/etc/passwd</code> file is now visible to us showing all the users that live inside the system. One user that stands out and might be of interest of further investigation is the <em>flaconfeast</em> account. Another valuable information displayed here is the next column that might probably indicate the password of that account (<em>falconfeast:rootpassword</em>).</p><p>We can also get the password hash from the <code class="language-plaintext highlighter-rouge">/etc/shadow</code> file by passing the value of <code class="language-plaintext highlighter-rouge">../../../../etc/shadow</code> and crack it using Hashcat.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/LFI/Founduserfalconfeast.png" alt="Found user falconfeast" /> <em>Found user falconfeast in /etc/passwd file and a password candidate</em></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/LFI/passwordhash.png" alt="Falconfeast hash" /> <em>Found falcnfeast’s password hash in /etc/shadow file</em></p><h2 id="login-via-ssh-as-falconfeast">Login via SSH as falconfeast</h2><p>We need to find the user flag so we login via SSH as falconfeast user using the password of rootpassword. If it fail, that would mean we have to crack the obtained password hash because the password (<em>rootpassword</em>) was incorrect.</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="gp">#</span>ssh falconfeast@10.10.173.178                  
<span class="gp">falconfeast@inclusion:~$</span><span class="w"> </span><span class="nb">pwd</span>
<span class="go">/home/falconfeast
</span><span class="gp">falconfeast@inclusion:~$</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-l</span>
<span class="go">total 8
drwxr-xr-x 2 root        root        4096 Jan 21  2020 articles
-rw-r--r-- 1 falconfeast falconfeast   21 Jan 22  2020 user.txt
</span><span class="gp">falconfeast@inclusion:~$</span><span class="w"> </span><span class="nb">cat </span>user.txt 
</pre></table></code></div></div><h2 id="privilege-escalation">Privilege Escalation</h2><p>The password (rootpassword) found at <code class="language-plaintext highlighter-rouge">/etc/passwd</code> gave us access to flaconfeast’s account and we are now logged into the system with user privileges. Our next goal is to escalate our privileges for gaining root access and find the root flag.</p><p>We need to find a vector such as a binary that falconfeast can execute as superuser and exploit it to gain root access. By using <code class="language-plaintext highlighter-rouge">sudo -l</code> we can check if falconfeast is able to execute any command as a superuser in that machine.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/LFI/sudo-l.png" alt="Sudo -l" /> <em>What commands falconfeast can execute as superuser?</em></p><p>As we can see falconfeast can execute as the root user the <code class="language-plaintext highlighter-rouge">/usr/bin/socat</code> command.</p><p>Lets visit <a href="https://gtfobins.github.io/gtfobins/socat/#sudo" target="_blank">GTFOBins</a> website and find a way to exploit socat.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/LFI/gtfo.png" alt="GTFOBins" /> <em>GTFOBins sudo socat</em></p><p>Now we need to run the command that will give us root access on the system and will find the root flag.</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="gp">falconfeast@inclusion:~$</span><span class="w"> </span><span class="nb">sudo </span>socat stdin <span class="nb">exec</span>:/bin/sh
<span class="go">whoami
root
pwd
/home/falconfeast
cd /root
ls -l
total 4
-rw-r--r-- 1 root root 21 Jan 22  2020 root.txt
cat root.txt
</span></pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctfs/'>CTFs</a>, <a href='/categories/tryhackme/'>TryHackMe</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/tryhackme/" class="post-tag no-text-decoration" >tryhackme</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Local File Inclusion CTF - Dimitris Tsarouchas&url=https://dimitrios-tsarouchas.tech//posts/Local-File-Inclusion-CTF/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Local File Inclusion CTF - Dimitris Tsarouchas&u=https://dimitrios-tsarouchas.tech//posts/Local-File-Inclusion-CTF/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Local File Inclusion CTF - Dimitris Tsarouchas&url=https://dimitrios-tsarouchas.tech//posts/Local-File-Inclusion-CTF/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Active-Directory/">Active Directory</a><li><a href="/posts/Threat-Actors/">Threat Actors</a><li><a href="/posts/Local-File-Inclusion-CTF/">Local File Inclusion CTF</a><li><a href="/posts/Local-File-Inclusion/">Local File Inclusion (LFI) Vulnerability</a><li><a href="/posts/Tmux/">Tmux</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/information-security/">information security</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/apts/">APTs</a> <a class="post-tag" href="/tags/cia-triad/">cia triad</a> <a class="post-tag" href="/tags/cve-2019-14287/">CVE-2019-14287</a> <a class="post-tag" href="/tags/hacktivists/">hacktivists</a> <a class="post-tag" href="/tags/script-kiddies/">script kiddies</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Local-File-Inclusion/"><div class="card-body"> <span class="timeago small" > Feb 1 <i class="unloaded">2021-02-01T12:55:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Local File Inclusion (LFI) Vulnerability</h3><div class="text-muted small"><p> Image from netsparker.com Introduction We are going to exploit a Linux machine that is vulnerable to Local File Inclusion attack. This will be done by using the Path Traversal technique. We will g...</p></div></div></a></div><div class="card"> <a href="/posts/Kenobi/"><div class="card-body"> <span class="timeago small" > Jan 18 <i class="unloaded">2021-01-18T12:55:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Kenobi</h3><div class="text-muted small"><p> Introduction We are going to exploit a Linux machine called Kenobi. We will enumerate a share service called Samba and try to get initial access on the machine by manipulating a vulnerable versio...</p></div></div></a></div><div class="card"> <a href="/posts/Sudo-Security-Bypass/"><div class="card-body"> <span class="timeago small" > Jan 23 <i class="unloaded">2021-01-23T12:55:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Sudo - Security Bypass (CVE:2019-14287)</h3><div class="text-muted small"><p> Introduction In this post we are going to exploit a vulnerability found in the sudo program by Joe Vennix in 2019. This vulnerability has been patched in newer versions of Linux but it may still...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Local-File-Inclusion/" class="btn btn-outline-primary"><p>Local File Inclusion (LFI) Vulnerability</p></a> <a href="/posts/Goals-of-Security/" class="btn btn-outline-primary"><p>Goals of Security</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/DimitriosTsaro3">Dimitrios Tsarouchas</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/information-security/">information security</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/apts/">APTs</a> <a class="post-tag" href="/tags/cia-triad/">cia triad</a> <a class="post-tag" href="/tags/cve-2019-14287/">CVE 2019 14287</a> <a class="post-tag" href="/tags/hacktivists/">hacktivists</a> <a class="post-tag" href="/tags/script-kiddies/">script kiddies</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://dimitrios-tsarouchas.tech/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
